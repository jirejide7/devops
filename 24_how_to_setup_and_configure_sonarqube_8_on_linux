sudo su
SONARQUBE=sonarqube-8.1.0.31237 # the version number will change over time
wget https://binaries.sonarsource.com/Distribution/sonarqube/$SONARQUBE.zip
apt install -y unzip
unzip $SONARQUBE.zip -d /opt
mv /opt/$SONARQUBE /opt/sonarqube -v

groupadd $SONARQUBE_GROUP
useradd --comment "Sonar System user" --home-dir /opt/sonarqube -g $SONARQUBE_GROUP $SONAR_USERNAME
mkdir -p /var/sonarqube/data /var/sonarqube/temp
chown -R $SONARQUBE_USERNAME:$SONARQUBE_GROUP /opt/sonarqube/data
chown -R $SONARQUBE_USERNAME:$SONARQUBE_GROUP /opt/sonarqube/extensions
chown -R $SONARQUBE_USERNAME:$SONARQUBE_GROUP /var/sonarqube/data
chown -R $SONARQUBE_USERNAME:$SONARQUBE_GROUP /var/sonarqube/temp

nano opt/sonarcube/conf/sonar.properties
sonar.jdbc.username=$POSTGRESQL_USERNAME
sonar.jdbc.password=$POSTRGESQL_PASSWORD
sonar.jdbc.url=jdbc:postgresql://localhost/sonarqube_database

sonar.path.data=/var/sonarqube/data
sonar.path.temp=/var/sonarqube/temp

sonar.web.javaOpts=-server
ctrl+x
y
exit

nano /opt/sonarqube/bin/linux-x86-64/sonar.sh
RUN_AS_USER=$SONARQUBE_USERNAME
ctrl+x
y

su $SONARQUBE_USERNAME
cd /opt/sonarqube/bin/linux-x86-64/
./sonar.sh start
./sonar.sh status
cat /opt/sonarqube/logs/sonar.log
tail /opt/sonarqube/logs/sonar.log
exit
exit
curl localhost:9000
